# TrueChain黄皮书解读
简书地址：https://www.jianshu.com/p/4c81d8fcd54a

2018是众多公链纷争的一年，而公链当前面临的最大问题是安全和效率的矛盾，即如何在去中心化程度和高TPS两者之间取得平衡，最典型的代表如以太坊和EOS之争，EOS的开发者BM批评以太坊网络拥堵，V神批评EOS只有21个节点，节点少速度快当然容易。


EOS没有以太坊安全可靠，以太坊有10000个节点，攻击21个节点比攻击10000个节点容易得多。

但是以太坊没有EOS效率高，以前EOS的宣传卖点主要是每秒能处理百万级交易量，不过前段时间改口了，只剩数千TPS，但也比以太坊速度高100倍了

## 通过Truechain的黄皮书看看truechain

> 初链：高性能去中心化公开账本。从2017年11月启动至今，经过历时近一年的研究、开发与测试，初链主网Beta版于新加坡时间2018年09月28日08:00正式上线，在07:56分PBFT委员会第一次共识出块和TrueChain fPOW创世区块被挖出。



**初链是采用双链结构实现混合共识(bpft + fpow)的公链:**

单一共识已经无法找到效率和安全的平衡点，初链作为高性能去中心化的公开账本，使用PBFT和fPOW混合共识的设计模式来尽可能偏向那个平衡点，fPOW共识确保了激励和委员会的选择，PBFT层作为一种高效的共识，如快速的终结性，高通量，交易验证，公平贸易经济的轮值委员会，以及处理非统一基础设施的补偿基础设施，混合协议的本质允许它最大限度地容忍大约三分之一的对等节点的腐败。


- 水果链：

	采用水果链作为慢链(snailchain),用以代替Nakamoto(传统链),以抵御1/3−ε腐败
(inhashpower)随机小常数ε,以获得最优的适应性。水果链的好处：

  - 1.能抵制联合挖矿
  
		水果(Fruits)比区块(Blocks)挖矿难度低, 普通挖矿,个人平均两年才能挖到一个矿,但水果却一天可以挖到两个,这样矿工形成的矿池的动力就变小了,从而抵制了联合挖矿,使得PoW更加公平。

  - 2.能抵制自私挖矿

		水果在被写入区块前都不稳定,而且存在一定的保质期,算法规定包含最多水果的块为主链,所以矿工挖矿需要尽快将水果收到区块里,而不能默不作声地等着浪费别人的算力,从而抵制了自私挖矿; 而矿工将水果收入会先得到挖矿奖励,再将一定奖励分发给包涵进区块的水果。

  - 3.乱序挖矿
	  
		fPoW协议使得水果的挖矿顺序可以为任意顺序,即可以并行挖矿,在Sharding中非常有用。

- Daily 链下共识协议

	在DailyBFT中，委员会成员运行一个离线的BFT实例来决定每天的日志，而非成员则统计委
员会成员的签名数量。它将安全性扩展到非委员会成员和后期生成节点。它附带一项终止协
议，该协议要求所有诚实的节点在终止时同意相同的最终日志。在DailyBFT中，委员会成员
输出签名的每天的日志哈希，然后被混合共识协议使用。这些签名的日志哈希满足完整性和
不可伪造性。


	在公钥生成器上，将公钥添加到公钥列表中。在收到通讯信号后，就会有条件地选择该节点
作为委员会成员。环境使委员会有选择地开放。

	子协议在节点是BFT委员会成员时的工作方式: 分叉一个BFT虚拟节点。这里的BFT虚拟节点
由BFTpk表示，然后开始接收TXs(交易)。如果停⽌信号由至少三分之一的初始委员会特定
公钥签名，则检查日志完成结束。在此期间，将进行连续的“直到完成”检查，一旦每个步骤
都完成了gossip，所有停止日志条目将被删除。

	当节点不是BFT成员时，子协议的工作原理如下: 在接收交易时，消息被添加到历史记录中，
并由三分之一的初始委员会特定公钥签名

	签名算法用前缀0标记内部BFT实例的每个消息，用前缀1标记外部DailyBFT的每个消息，以
避免命名空间冲突。


**原创性实现安全的混合共识PBFT委员会的随机选举机制**

 　　初链“交易处理担当”主要为PBFT委员会，为保证公平和安全性，初链PBFT委员会将定期换届，那么如何在在换届时公平地选举PBFT委员这一过程最为重要。初恋为了解决这个问题实现了随机算法，基于VRF(verify random function，可验证随机函数)可以实现PBFT节点等概率的公平选举。而这里面也会有一些过滤，过滤掉一些挖水果特别少的矿工，因为他们挖的特别少，可能他们的硬件设备或者网络情况不太好。从剩下满足处理交易条件的节点中，随机的公平的选举出来PBFT委员会成员。


	
